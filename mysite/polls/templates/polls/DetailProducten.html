<!DOCTYPE html>
<html>
{% load static %}
<link rel="stylesheet" href="{% static 'polls/style.css' %}">

<head>
    <title>Product data</title>
    <h1>Product data</h1>
    <a href="/" id="Home button">Home</a>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>


<body>
    <div>
        <div class="row">
            <div class="column1" style="display: inline-block; width: 49%;">
                <div id="sales-bar-chart"></div>
            </div>
        </div>
        <h1>machine learing</h1>
        <h1>Random Forest accuracy:</h1>
        <h1 id="output"></h1>
    </div>
    <script>
        updateCharts();

        setInterval(updateCharts, 300000);

        function updateCharts() {
            fetch('/getProductSales')
                .then(response => response.json())
                .then(data => {
                    var sales_per_region = data.sales_per_region;
                    Plotly.react('sales-bar-chart', [{
                        x: sales_per_region.map(item => item.region),
                        y: sales_per_region.map(item => item.total_product_sales),
                        type: 'bar',
                        marker: {
                            color: '#e377c2'
                        },
                        title: 'Sales per Regio',
                    }], {
                        title: {
                            text: 'Sales per Regio',
                            font: {
                                color: '#ffffff'
                            }
                        },
                        plot_bgcolor: '#212121',
                        paper_bgcolor: '#212121',
                        yaxis: {
                            title: 'Hoeveelheid producten',
                            color: '#ffffff',
                            tickfont: {
                                color: '#ffffff'
                            }
                        },
                        xaxis: {
                            title: 'Regio',
                            color: '#ffffff',
                            tickfont: {
                                color: '#ffffff'
                            },
                        }
                    });
                })
                .catch(error => {
                    console.error(error);
                });


            fetch('/predict_bonus')
                .then(response => response.json())
                .then(data => {
                    var output = document.getElementById("output");
                    output.innerHTML = data;
                })
                .catch(error => {
                    console.error(error);
                });
        }




    </script>
</body>

</html>